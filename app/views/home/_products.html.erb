<!-- start products section -->

<section class="products-section wow animate__fadeIn" id="products">
    <div class="products-container">
        <div class="products-layout">
            <!-- Left Column: Images -->
            <div class="products-images-col">
                <% Product.all.each_with_index do |product, index| %>
                    <div class="product-image-wrapper <%= 'active' if index == 0 %>" 
                         id="product-img-<%= product.id %>"
                         onclick="activateProduct(this, '<%= product.id %>')">
                        <% if product.image.attached? %>
                            <%= image_tag product.image, alt: product.name %>
                        <% else %>
                            <img src="https://placehold.co/1303x620" alt="<%= product.name %>">
                        <% end %>
                        <a href="<%= product_path(product) %>" class="see-details-link">See details</a>
                    </div>
                <% end %>
            </div>

            <!-- Right Column: Content -->
            <div class="products-content-col">
                <div class="products-title">Our Products</div>
                <div class="products-description">
                    <p>Designed with precision and purpose, our aluminium solutions create seamless connections between your home and its surroundings.</p>
                    <p>Each product delivers strength, style, and tranquility, turning walls into windows and views into the centerpiece of living.</p>
                </div>
                
                <ul class="product-nav">
                    <% Product.all.each_with_index do |product, index| %>
                        <li class="product-nav-item">
                            <a href="javascript:void(0);" 
                               class="product-nav-link <%= 'active' if index == 0 %>" 
                               id="product-link-<%= product.id %>"
                               data-target-id="<%= product.id %>"
                               onclick="switchProduct(this)">
                                <%= product.name %>
                            </a>
                        </li>
                    <% end %>
                </ul>
            </div>
        </div>
    </div>
</section>

<script>
    function switchProduct(linkElement) {
        const productId = linkElement.getAttribute('data-target-id');
        activateProductById(productId);
    }

    function activateProduct(imageElement, productId) {
        if (!imageElement.classList.contains('active')) {
            activateProductById(productId);
        }
    }

    function activateProductById(productId) {
        // Remove active class from all links
        document.querySelectorAll('.product-nav-link').forEach(link => {
            link.classList.remove('active');
        });
        
        // Add active class to target link
        const targetLink = document.getElementById('product-link-' + productId);
        if (targetLink) {
            targetLink.classList.add('active');
        }
        
        // Remove active class from all images
        document.querySelectorAll('.product-image-wrapper').forEach(img => {
            img.classList.remove('active');
        });
        
        // Add active class to target image
        const targetImage = document.getElementById('product-img-' + productId);
        if (targetImage) {
            targetImage.classList.add('active');
        }
    }
</script>
<!-- end products section -->